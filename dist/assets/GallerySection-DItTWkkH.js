import{r as a,j as e,m as Z,A as ge}from"./animations-w5RCdeks.js";import{u as pe,b as Ae,c as ee,B as Y,d as Ue,D as oa,e as na,f as ca,g as Pe}from"./index-FEn-eR-a.js";import{bg as $e,ar as da,X as ve,aI as Ze,bh as He,aE as Ge,au as ua,y as ma,M as De,af as _e,U as Xe,aW as pa,bi as ha,bj as Ye,as as Be,a0 as Me,bk as xa,bl as ga,bm as ba,aF as Je,bn as de,bo as Ke,S as qe,H as fa,bp as va,bq as ya,br as ja}from"./ui-vuw2n6JC.js";import{I as Re}from"./ImageWithFallback-CX4aJ3oG.js";import{D as be,a as fe,u as wa,b as Se,c as ze,d as Ie,T as Na,S as me}from"./skeleton-D4vjSNg6.js";import{T as Qe}from"./textarea-DNfa1aEd.js";import{I as je}from"./input-BRZWmq00.js";import{u as Ca}from"./useModeracionImagen-BOrnn9hI.js";import"./vendor-BImi-76D.js";import"./charts-qq9cUDqM.js";import"./utils-BNe0Xlio.js";function Ea(t){const{language:d}=pe(),[c,l]=a.useState(null),[h,x]=a.useState(0),[v,z]=a.useState("todas"),[S,A]=a.useState("circular"),[H,k]=a.useState(1),[I,U]=a.useState(!0),[y,M]=a.useState(!1),[q,G]=a.useState(!1),[B,X]=a.useState(!1),E=a.useRef(null),V=["todas",...new Set(t.map(i=>i.category))],R=t.filter(i=>v==="todas"||i.category===v),K=i=>{const j=new Date(i),T={year:"numeric",month:"long",day:"numeric"};switch(d){case"es":return j.toLocaleDateString("es-ES",T);case"en":return j.toLocaleDateString("en-US",T);case"nah":return j.toLocaleDateString("es-ES",T);default:return j.toLocaleDateString("es-ES",T)}};a.useEffect(()=>{E.current&&(I?E.current.play().catch(console.error):E.current.pause())},[I]);const J=i=>{const j=R.findIndex(T=>T.src===i);j!==-1&&(x(j),l(i),k(1))},Q=()=>{l(null)},u=()=>{if(R.length===0)return;const i=h===R.length-1?0:h+1;x(i),l(R[i].src),k(1)},D=()=>{if(R.length===0)return;const i=h===0?R.length-1:h-1;x(i),l(R[i].src),k(1)},L=()=>k(i=>Math.min(i+.25,3)),P=()=>k(i=>Math.max(i-.25,1)),se=()=>k(1),_=c?R[h]:void 0,m=(i,j,T=!1)=>{const re=(T?120:180)+j*3,ae=i/j*Math.PI*2-Math.PI/2,ne=.9+Math.random()*.3,te=(Math.random()-.5)*8,ce=he=>{const oe=new Date(he),ie={year:"numeric",month:"long",day:"numeric"};switch(d){case"es":return oe.toLocaleDateString("es-ES",ie);case"en":return oe.toLocaleDateString("en-US",ie);case"nah":return oe.toLocaleDateString("es-ES",ie);default:return oe.toLocaleDateString("es-ES",ie)}};return{x:Math.cos(ae)*re,y:Math.sin(ae)*re,scale:ne,formatDate:ce,rotate:te}},[g,N]=a.useState(!1);return a.useEffect(()=>{const i=()=>N(window.innerWidth<768);return i(),window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[]),a.useEffect(()=>{g&&S==="circular"&&A("grid")},[g,S,A]),{formatDate:K,isYouTubeModalOpen:q,setIsYouTubeModalOpen:G,isVideoHovered:B,setIsVideoHovered:X,selectedImage:c,currentImageIndex:h,selectedCategory:v,viewMode:S,zoomLevel:H,isPlaying:I,isMuted:y,videoRef:E,categories:V,filteredImages:R,currentImage:_,setSelectedCategory:z,setViewMode:A,setIsPlaying:U,setIsMuted:M,openImage:J,closeImage:Q,nextImage:u,prevImage:D,handleZoomIn:L,handleZoomOut:P,handleResetZoom:se,isMobile:g,getCircularPosition:(i,j)=>m(i,j,g)}}function ka({isGridMode:t=!1,onVideoClick:d,isVideoHovered:c,onVideoHover:l}){const{t:h}=pe(),x=["4r2isHLCNFo"],[v]=a.useState(x[0]),[z,S]=a.useState(!1),A=`https://img.youtube.com/vi/${v}/maxresdefault.jpg`;return e.jsxs(Z.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{duration:1,delay:.6},className:`relative ${t?"w-full h-full min-h-[300px] md:min-h-[400px]":"w-48 h-48 md:w-56 md:h-56"} rounded-2xl overflow-hidden shadow-2xl border-2 border-white/20 bg-gradient-to-br from-blue-500 to-emerald-500 cursor-pointer group`,onClick:d,onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),children:[e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:z?e.jsxs("div",{className:"w-full h-full flex items-center justify-center flex-col p-6 text-white text-center bg-gradient-to-br from-blue-500 to-emerald-500",children:[e.jsx($e,{className:"h-12 w-12 mb-3 opacity-90"}),e.jsxs("h3",{className:"font-semibold text-lg mb-2",children:[h("gallery.video.ourCommunity")," "]}),e.jsxs("p",{className:"text-sm opacity-90 mb-4",children:[h("gallery.video.clickToWatch")," "]}),e.jsxs("div",{className:"bg-white/20 px-3 py-1 rounded-full text-xs",children:["â–¶ï¸ ",h("gallery.video.play")," "]})]}):e.jsx("img",{src:A,alt:h("gallery.video.altText"),className:"w-full h-full object-cover",onError:()=>S(!0)})}),e.jsxs("div",{className:`absolute inset-0 bg-gradient-to-t from-black/80 via-black/30 to-black/20 transition-all duration-300 ${c?"opacity-100":"opacity-70"} group-hover:opacity-100 flex flex-col justify-between`,children:[e.jsx("div",{className:"flex justify-between items-start p-4",children:e.jsxs("div",{className:"bg-red-600 text-white px-3 py-1 rounded-full text-xs font-semibold flex items-center gap-1 backdrop-blur-sm",children:[e.jsx($e,{className:"h-3 w-3"}),h("gallery.video.youtube")," "]})}),e.jsxs("div",{className:"p-4 text-white transform transition-transform duration-300",children:[e.jsxs("h3",{className:`
            font-semibold mb-2 
            ${t?"text-lg md:text-xl text-center md:text-left":"text-sm text-center"}
          `,children:[h("gallery.video.ourCommunity")," "]}),e.jsxs("p",{className:`
            opacity-90 mb-4 
            ${t?"text-sm md:text-base text-center md:text-left":"text-xs text-center hidden"}
          `,children:[h("gallery.video.discoverEssence")," "]}),e.jsx("div",{className:"flex justify-center md:justify-start",children:e.jsxs(Z.div,{animate:{scale:c?[1,1.1,1]:1},transition:{duration:1.5,repeat:c?1/0:0},className:`
                bg-red-600 text-white rounded-full shadow-2xl border-2 border-white/30 
                flex items-center gap-2 hover:bg-red-700 transition-colors duration-200
                ${t?"px-6 py-3":"px-3 py-1.5"}
              `,children:[e.jsx(da,{className:`
                fill-current 
                ${t?"h-5 w-5":"h-3 w-3"} // âœ… Icono mÃ¡s pequeÃ±o en circular
              `}),e.jsx("span",{className:`
                font-semibold 
                ${t?"text-sm":"text-xs"} // âœ… Texto mÃ¡s pequeÃ±o en circular
              `,children:h(t?"gallery.video.playVideo":"gallery.video.play")})]})})]})]}),e.jsx("div",{className:`absolute inset-0 border-3 transition-all duration-300 rounded-2xl ${c?"border-red-500/40":"border-transparent"} group-hover:border-red-500/40`})]})}function Ma({images:t,getCircularPosition:d,onImageClick:c,isMobile:l}){const h=(x,v)=>v-x;return e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center",children:[e.jsx(ge,{children:t.map((x,v)=>{const z=d(v,t.length),S=h(v,t.length);return e.jsx(Z.div,{initial:{x:0,y:0,scale:0,opacity:0,rotate:0},animate:{x:z.x,y:z.y,scale:z.scale,opacity:1,rotate:z.rotate},exit:{x:0,y:0,scale:0,opacity:0,rotate:0},transition:{duration:l?.4:.8,delay:l?v*.05:v*.1,type:l?"tween":"spring",stiffness:l?void 0:50,damping:l?void 0:15},whileHover:l?void 0:{scale:z.scale*1.15,rotate:0,zIndex:1e3,transition:{duration:.3,type:"spring",stiffness:300}},className:"absolute left-1/2 top-1/2",style:{zIndex:S,marginLeft:`-${t.length>8?"5rem":"4rem"}`,marginTop:`-${t.length>8?"5rem":"4rem"}`},children:e.jsxs(Z.div,{className:"group relative rounded-2xl overflow-hidden cursor-pointer shadow-2xl border-2 border-white/10 hover:border-white/30 transition-all duration-500 bg-slate-800/50 backdrop-blur-sm",style:{width:t.length>8?"10rem":"12rem",height:t.length>8?"10rem":"12rem"},onClick:()=>c(x.src),children:[e.jsx(Re,{src:x.src,alt:x.alt,className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/90 via-black/30 to-transparent opacity-0 group-hover:opacity-100 transition-all duration-500",children:e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-3 text-white transform translate-y-4 group-hover:translate-y-0 transition-transform duration-500",children:[e.jsx("h3",{className:"text-xs font-semibold mb-1 line-clamp-1 text-center",children:x.title}),e.jsx("div",{className:"text-[10px] opacity-90 bg-black/70 px-2 py-1 rounded-full inline-block mx-auto text-center w-fit",children:x.category})]})}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-1000"})]})},`${x.src}-${v}`)})}),!1]})}function Sa({images:t,onImageClick:d,isMobile:c}){return e.jsx(Z.div,{layout:!0,className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:e.jsx(ge,{children:t.map((l,h)=>e.jsxs(Z.div,{layout:!0,initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:c?.3:.5,delay:c?h*.05:h*.1},className:`group relative aspect-square rounded-2xl overflow-hidden cursor-pointer shadow-lg ${c?"":"hover:shadow-2xl transform transition-all duration-500"}`,onClick:()=>d(l.src),children:[e.jsx(Re,{src:l.src,alt:l.alt,className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-all duration-500",children:e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4 text-white",children:[e.jsx("h3",{className:"text-sm font-semibold mb-1",children:l.title}),e.jsx("div",{className:"text-xs opacity-80 bg-black/50 px-2 py-1 rounded-full inline-block",children:l.category})]})})]},`grid-${l.src}-${h}`))})})}function za({isOpen:t,onClose:d,image:c,currentIndex:l,totalImages:h,zoomLevel:x,onNext:v,onPrev:z,onZoomIn:S,onZoomOut:A,onResetZoom:H,formatDate:k}){const[I,U]=a.useState(!1),{t:y}=pe(),M=q=>{switch(q){case"paisajes":return y("gallery.landscapes");case"naturaleza":return y("gallery.nature");case"cultura":return y("gallery.culture");case"comunidad":return y("gallery.community");case"tradiciones":return y("gallery.traditions");default:return q}};return c?e.jsx(be,{open:t,onOpenChange:d,children:e.jsx(fe,{className:"max-w-7xl w-full h-[90vh] p-0 overflow-hidden bg-slate-900/5 backdrop-blur-sm border-0",children:e.jsx(ge,{children:t&&e.jsxs(Z.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"relative w-full h-full flex flex-col lg:flex-row",children:[e.jsxs("div",{className:"flex-1 relative flex items-center justify-center p-3 sm:p-4 min-h-[45vh] lg:min-h-0",children:[e.jsxs("div",{className:"absolute top-3 left-3 right-3 z-20 flex justify-between items-center",children:[e.jsx("button",{onClick:d,className:"bg-slate-800/80 text-white p-3 rounded-full hover:bg-slate-700/80 transition-colors duration-200 backdrop-blur-sm","aria-label":y("gallery.modal.close"),children:e.jsx(ve,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:A,disabled:x<=1,className:"bg-slate-800/80 text-white p-3 rounded-full hover:bg-slate-700/80 transition-colors duration-200 backdrop-blur-sm disabled:opacity-50","aria-label":y("gallery.modal.zoomOut"),children:e.jsx(Ze,{className:"h-5 w-5"})}),e.jsx("button",{onClick:H,className:"bg-slate-800/80 text-white p-3 rounded-full hover:bg-slate-700/80 transition-colors duration-200 backdrop-blur-sm","aria-label":y("gallery.modal.resetZoom"),children:e.jsx(He,{className:"h-5 w-5"})}),e.jsx("button",{onClick:S,disabled:x>=3,className:"bg-slate-800/80 text-white p-3 rounded-full hover:bg-slate-700/80 transition-colors duration-200 backdrop-blur-sm disabled:opacity-50","aria-label":y("gallery.modal.zoomIn"),children:e.jsx(Ge,{className:"h-5 w-5"})})]})]}),h>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:z,className:"absolute left-2 lg:left-4 top-1/2 transform -translate-y-1/2 bg-slate-800/80 text-white p-3 lg:p-4 rounded-full hover:bg-slate-700/80 transition-colors duration-200 backdrop-blur-sm z-20",children:e.jsx(ua,{className:"h-6 w-6"})}),e.jsx("button",{onClick:v,className:"absolute right-2 lg:right-4 top-1/2 transform -translate-y-1/2 bg-slate-800/80 text-white p-3 lg:p-4 rounded-full hover:bg-slate-700/80 transition-colors duration-200 backdrop-blur-sm z-20",children:e.jsx(ma,{className:"h-6 w-6"})})]}),e.jsx(Z.div,{className:`relative overflow-hidden rounded-lg ${I?"opacity-100":"opacity-0"} transition-opacity duration-500`,style:{transform:`scale(${x})`,transition:"transform 0.3s ease"},children:e.jsx(Re,{src:c.src,alt:c.alt,className:"max-w-full max-h-[40vh] lg:max-h-[70vh] object-contain",onLoad:()=>U(!0)})}),h>1&&e.jsxs("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-slate-800/80 text-white px-4 py-2 rounded-full backdrop-blur-sm text-sm",children:[l+1," / ",h]})]}),e.jsx(Z.div,{initial:{x:300},animate:{x:0},exit:{x:300},className:"w-full lg:w-96 bg-slate-800/25 backdrop-blur-sm p-4 sm:p-6 overflow-y-auto max-h-[45vh] lg:max-h-none border-t lg:border-t-0 lg:border-l border-slate-700/50",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 pb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-3 font-serif",children:c.title}),e.jsx("p",{className:"text-slate-300 leading-relaxed",children:c.description})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-400",children:[e.jsx(De,{className:"h-4 w-4 text-blue-400"}),e.jsx("span",{children:c.location})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-400",children:[e.jsx(_e,{className:"h-4 w-4 text-emerald-400"}),e.jsx("span",{children:k(c.date)})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-400",children:[e.jsx(Xe,{className:"h-4 w-4 text-violet-400"}),e.jsxs("span",{children:[y("gallery.modal.photographer")," ",c.photographer]})," "]})]}),e.jsx("div",{className:"bg-slate-700/50 rounded-lg p-4 border border-slate-600/50",children:e.jsxs("span",{className:"text-slate-300 text-sm font-medium",children:[y("gallery.modal.category")," ",e.jsxs("span",{className:"text-blue-400 capitalize",children:[M(c.category)," "]})]})}),e.jsxs("div",{className:"pt-4 border-t border-slate-700/50",children:[e.jsxs("h4",{className:"text-sm font-semibold text-slate-300 mb-2",children:[y("gallery.modal.technicalInfo")," "]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-slate-400",children:[e.jsxs("div",{children:[y("gallery.modal.zoom")," ",(x*100).toFixed(0),"% "]}),e.jsxs("div",{children:[y("gallery.modal.imageOf")," ",l+1," ",y("gallery.modal.imageOf")," ",h," "]})]})]})]})})]})})})}):null}function Ia({viewMode:t,onViewModeChange:d,isMobile:c=!1}){const{t:l}=pe();return c?e.jsx(Z.div,{initial:{opacity:0},whileInView:{opacity:1},transition:{duration:.6,delay:.4},className:"flex justify-center mb-8",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500/20 to-emerald-500/20 backdrop-blur-sm rounded-2xl p-4 border border-blue-500/30",children:e.jsxs("div",{className:"flex items-center gap-0 text-sm",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-emerald-500 rounded-full flex items-center justify-center",children:"ðŸ“±"}),e.jsxs("span",{className:"text-white font-medium",children:[l("gallery.viewMode.mobileView")," "]})]})})}):e.jsx(Z.div,{initial:{opacity:0},whileInView:{opacity:1},transition:{duration:.6,delay:.4},className:"flex justify-center mb-8",children:e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur-sm rounded-2xl p-1 border border-slate-700/50",children:[e.jsxs("button",{onClick:()=>d("circular"),className:`px-6 py-3 rounded-xl text-sm font-medium font-serif transition-all duration-300 ${t==="circular"?"bg-gradient-to-r from-blue-500 to-emerald-500 text-white shadow-lg":"text-slate-400 hover:text-white hover:bg-slate-700/50"}`,children:[l("gallery.viewMode.circularView")," "]}),e.jsxs("button",{onClick:()=>d("grid"),className:`px-6 py-3 rounded-xl text-sm font-serif transition-all duration-300 ${t==="grid"?"bg-gradient-to-r from-blue-500 to-emerald-500 text-white shadow-lg":"text-slate-400 hover:text-white hover:bg-slate-700/50"}`,children:[l("gallery.viewMode.gridView")," "]})]})})}function Ta({isOpen:t,onClose:d,videoId:c}){const{t:l}=pe(),h=`https://www.youtube.com/embed/${c}?autoplay=1&rel=0&modestbranding=1&playsinline=1`;return e.jsx(be,{open:t,onOpenChange:d,children:e.jsx(fe,{className:"max-w-6xl w-full h-[90vh] p-0 overflow-hidden bg-black border-0",children:e.jsxs(Z.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"relative w-full h-full bg-black",children:[e.jsx("button",{onClick:d,className:"absolute top-4 right-4 z-50 bg-black/80 text-white p-3 rounded-full hover:bg-red-600 transition-all duration-200 backdrop-blur-sm border border-white/20","aria-label":l("gallery.modal.close"),children:e.jsx(ve,{className:"h-5 w-5"})}),e.jsxs("a",{href:`https://youtube.com/watch?v=${c}`,target:"_blank",rel:"noopener noreferrer",className:"absolute top-4 left-4 z-50 bg-black/80 text-white px-4 py-2 rounded-full hover:bg-red-600 transition-all duration-200 backdrop-blur-sm border border-white/20 flex items-center gap-2 text-sm",children:[e.jsx(pa,{className:"h-4 w-4"}),l("gallery.youtubeModal.watchOnYouTube")," "]}),e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-black",children:e.jsx("div",{className:"w-full h-full max-w-4xl max-h-full",children:e.jsx("iframe",{src:h,className:"w-full h-full",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0,title:l("gallery.youtubeModal.videoTitle"),style:{border:"none"}})})})]})})})}const Aa=[{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763072851/IMG-20251113-WA0007_vmbpfk.jpg",alt:"Amanecer en la Sierra Madre",category:"paisajes",title:"Amanecer en la Sierra",description:"Los primeros rayos del sol acarician las cumbres ancestrales de nuestro territorio",date:"2024-01-15",location:"Cerro del Ãguila",photographer:"Juan MartÃ­nez"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763072850/IMG-20251113-WA0004_jq7cro.jpg",alt:"Bosque de conÃ­feras nativas",category:"naturaleza",title:"Bosque Ancestral",description:"Donde los Ã¡rboles centenarios guardan la memoria de nuestra tierra",date:"2024-02-03",location:"Bosque de los Abuelos",photographer:"MarÃ­a GonzÃ¡lez"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763072850/IMG-20251113-WA0006_snt6gk.jpg",alt:"Cascada cristalina en la montaÃ±a",category:"naturaleza",title:"Cascada Xochitl",description:"El canto del agua que purifica y renueva la vida en nuestro ecosistema",date:"2024-01-22",location:"CaÃ±ada de las Flores",photographer:"Carlos Ruiz"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763073766/morrales_wohiwy.jpg",alt:"Tejidos tradicionales en telar",category:"cultura",title:"Telares de TradiciÃ³n",description:"Hilos que entrelazan historias, colores que pintan identidad",date:"2024-03-10",location:"Taller Comunitario",photographer:"Ana Torres"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763072851/IMG-20251113-WA0008_qe5joq.jpg",alt:"Trabajo colectivo en el campo",category:"comunidad",title:"Tequio que Une",description:"Manos que trabajan juntas, corazones que laten al mismo ritmo",date:"2024-02-18",location:"Campos Comunales",photographer:"Pedro HernÃ¡ndez"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763073856/dansz_psbbaj.jpg",alt:"Festival tradicional con danzas",category:"tradiciones",title:"Danzas del Sol",description:"Ritmos ancestrales que celebran la conexiÃ³n con el cosmos",date:"2024-03-15",location:"Plaza Principal",photographer:"Laura Mendoza"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763074242/Puente_fwky8r.jpg",alt:"Arquitectura vernÃ¡cula local",category:"cultura",title:"Casas que Respiran",description:"Espacios construidos con materiales de la tierra, diseÃ±ados con sabidurÃ­a ancestral",date:"2024-03-05",location:"Barrio Antiguo",photographer:"Roberto DÃ­az"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763073767/ninos_z8aczb.jpg",alt:"NiÃ±os aprendiendo en la naturaleza",category:"comunidad",title:"Semillas del MaÃ±ana",description:"El conocimiento que florece entre juegos y risas en nuestro entorno natural",date:"2024-02-12",location:"Escuela al Aire Libre",photographer:"Sofia Castro"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763062497/Comedor_hfora9.webp",alt:"PreparaciÃ³n de comida tradicional",category:"tradiciones",title:"Sabores que Cuentan",description:"Recetas que guardan el secreto de generaciones y el sabor de nuestra identidad",date:"2024-03-20",location:"Cocina Comunitaria",photographer:"Miguel Ãngel"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763073436/SanJuan-Noche_atm0mw.jpg",alt:"Cielo estrellado sobre la comunidad",category:"paisajes",title:"Manto Estrellado",description:"Noches donde el universo se acerca para susurrar secretos ancestrales",date:"2024-01-28",location:"Mirador Celestial",photographer:"Elena Morales"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763072850/IMG-20251113-WA0005_f3sq5h.jpg",alt:"Jugo Yektanesk",category:"Bebida artesanal",title:"SabidurÃ­a Verde",description:"Vive los sabores de nuestra comunidad",date:"2024-02-25",location:"JardÃ­n de Medicinas",photographer:"Isabel RamÃ­rez"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763072850/IMG-20251113-WA0002_ynkm8x.jpg",alt:"Visitanos esteremos esperandote",category:"cultura",title:"Vive, siente",description:"Un pueblo que vale la pena conocer",date:"2024-03-08",location:"San Juan Tahitic",photographer:"Municipio de Zacapoaxtla"}],Ve={galleryImages:Aa},Da=[{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763072851/IMG-20251113-WA0007_vmbpfk.jpg",alt:"Sunrise in the Sierra Madre",category:"landscapes",title:"Sunrise in the Sierra",description:"The first rays of the sun caress the ancestral peaks of our territory",date:"2024-01-15",location:"Eagle's Hill",photographer:"Juan MartÃ­nez"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763072850/IMG-20251113-WA0004_jq7cro.jpg",alt:"Native coniferous forest",category:"nature",title:"Ancestral Forest",description:"Where the centenary trees keep the memory of our land",date:"2024-02-03",location:"Forest of the Elders",photographer:"MarÃ­a GonzÃ¡lez"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763072850/IMG-20251113-WA0006_snt6gk.jpg",alt:"Crystal clear waterfall in the mountains",category:"nature",title:"Xochitl Waterfall",description:"The song of the water that purifies and renews life in our ecosystem",date:"2024-01-22",location:"Glen of the Flowers",photographer:"Carlos Ruiz"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763073766/morrales_wohiwy.jpg",alt:"Traditional weavings on a loom",category:"culture",title:"Looms of Tradition",description:"Threads that weave stories, colors that paint identity",date:"2024-03-10",location:"Community Workshop",photographer:"Ana Torres"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763072851/IMG-20251113-WA0008_qe5joq.jpg",alt:"Collective work in the field",category:"community",title:"Tequio that Unites",description:"Hands that work together, hearts that beat to the same rhythm",date:"2024-02-18",location:"Communal Fields",photographer:"Pedro HernÃ¡ndez"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763073856/dansz_psbbaj.jpg",alt:"Traditional festival with dances",category:"traditions",title:"Dances of the Sun",description:"Ancestral rhythms that celebrate the connection with the cosmos",date:"2024-03-15",location:"Main Square",photographer:"Laura Mendoza"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763074242/Puente_fwky8r.jpg",alt:"Local vernacular architecture",category:"culture",title:"Houses that Breathe",description:"Spaces built with materials from the earth, designed with ancestral wisdom",date:"2024-03-05",location:"Old Quarter",photographer:"Roberto DÃ­az"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763073767/ninos_z8aczb.jpg",alt:"Children learning in nature",category:"community",title:"Seeds of Tomorrow",description:"Knowledge that blossoms amidst games and laughter in our natural environment",date:"2024-02-12",location:"Outdoor School",photographer:"Sofia Castro"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763062497/Comedor_hfora9.webp",alt:"Preparation of traditional food",category:"traditions",title:"Flavors that Tell Stories",description:"Recipes that hold the secret of generations and the flavor of our identity",date:"2024-03-20",location:"Community Kitchen",photographer:"Miguel Ãngel"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763073436/SanJuan-Noche_atm0mw.jpg",alt:"Starry sky over the community",category:"landscapes",title:"Starry Mantle",description:"Nights where the universe comes closer to whisper ancestral secrets",date:"2024-01-28",location:"Celestial Viewpoint",photographer:"Elena Morales"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763072850/IMG-20251113-WA0005_f3sq5h.jpg",alt:"Yektanesk Juice",category:"Artisanal beverage",title:"Green Wisdom",description:"Experience the flavors of our community",date:"2024-02-25",location:"Medicine Garden",photographer:"Isabel RamÃ­rez"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763072850/IMG-20251113-WA0002_ynkm8x.jpg",alt:"Visit us, we will be waiting for you",category:"culture",title:"Live, feel",description:"A town worth visiting",date:"2024-03-08",location:"San Juan Tahitic",photographer:"Municipality of Zacapoaxtla"}],_a={galleryImages:Da},Ra=[{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763072851/IMG-20251113-WA0007_vmbpfk.jpg",alt:"Tonalco ipan Sierra Madre",category:"paisajes",title:"Tonalco ipan Sierra",description:"Achto tlapalli tonatiuh quimictia tepemeh toancestro tlalpan",date:"2024-01-15",location:"Cerro del Ãguila",photographer:"Juan MartÃ­nez"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763072850/IMG-20251113-WA0004_jq7cro.jpg",alt:"Cuahuitl tlen cuahuitzquitl",category:"naturaleza",title:"Cuahuitl Huehue",description:"Canin cuahuitl centzontli quipiya iamox to tlalpan",date:"2024-02-03",location:"Bosque de los Abuelos",photographer:"MarÃ­a GonzÃ¡lez"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763072850/IMG-20251113-WA0006_snt6gk.jpg",alt:"Apatl cristalino ipan tepetl",category:"naturaleza",title:"Apatl Xochitl",description:"Cuicatl atl tlen tlazotla huan yancuic yolistli ipan totlahtolpan",date:"2024-01-22",location:"CaÃ±ada de las Flores",photographer:"Carlos Ruiz"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763073766/morrales_wohiwy.jpg",alt:"Tlamamalli tlen telar",category:"cultura",title:"Telares Tlen Tlahtol",description:"Tlapowalli tlen tlamamaliztli, tlapalli tlen tlahtol",date:"2024-03-10",location:"Taller Comunitario",photographer:"Ana Torres"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763072851/IMG-20251113-WA0008_qe5joq.jpg",alt:"Tequio ipan milpan",category:"comunidad",title:"Tequio Tlen Moneki",description:"Maitl tlen tequitl, yolotl tlen ceceni tlatlamanti",date:"2024-02-18",location:"Campos Comunales",photographer:"Pedro HernÃ¡ndez"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763073856/dansz_psbbaj.jpg",alt:"Ilhuitl tlen mitotiliztli",category:"tradiciones",title:"Mitotiliztli Tonatiuh",description:"Cuicatl huehue tlen ilhuitl tlen citlalin",date:"2024-03-15",location:"Plaza Principal",photographer:"Laura Mendoza"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763074242/Puente_fwky8r.jpg",alt:"Calli tlen tlalpan",category:"cultura",title:"Calli Tlen Ehecatl",description:"Tlalpan tlen tlalli, tlen yancuic tlamatiliztli",date:"2024-03-05",location:"Barrio Antiguo",photographer:"Roberto DÃ­az"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763073767/ninos_z8aczb.jpg",alt:"Piltontli tlen tlamatiliztli ipan tlalpan",category:"comunidad",title:"Xihuitl Tlen Huetztli",description:"Tlamatiliztli tlen xochitl ipan tlahtol huan chichinaualiztli",date:"2024-02-12",location:"Escuela al Aire Libre",photographer:"Sofia Castro"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763062497/Comedor_hfora9.webp",alt:"Tlaquetzaliztli tlen nacatl",category:"tradiciones",title:"Nacatl Tlen Tlahtol",description:"Tlaquetzaliztli tlen tlahtol huan nacatl tlen to tlahtol",date:"2024-03-20",location:"Cocina Comunitaria",photographer:"Miguel Ãngel"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763073436/SanJuan-Noche_atm0mw.jpg",alt:"Citlalin ipan altepetl",category:"paisajes",title:"Citlalin Tlapalli",description:"Yohualtlan citlalin quihualehua tlahtol huehue",date:"2024-01-28",location:"Mirador Celestial",photographer:"Elena Morales"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763072850/IMG-20251113-WA0005_f3sq5h.jpg",alt:"Xihuitl patli huan ticitl",category:"tradiciones",title:"Xihuitl Tlamatiliztli",description:"Xihuitl tlen patli, maitl tlen patani, tlamatiliztli tlen moneki",date:"2024-02-25",location:"JardÃ­n de Medicinas",photographer:"Isabel RamÃ­rez"},{src:"https://res.cloudinary.com/dinsl266g/image/upload/v1763072850/IMG-20251113-WA0002_ynkm8x.jpg",alt:"Tlachihualiztli tlen tlalpoctli",category:"cultura",title:"Tlalpoctli Tlen Yolotl",description:"Tlalpoctli tlen tlachihualiztli ipan comitl tlen quipiya toyolotl",date:"2024-03-08",location:"Taller de AlfarerÃ­a",photographer:"JosÃ© Luis"}],Oa={galleryImages:Ra};function La(){const{language:t,t:d}=pe(),[c,l]=a.useState(!1),[h,x]=a.useState(!1);a.useEffect(()=>{const i=()=>{const $=window.innerWidth;l($<768),x($>=768&&$<1024)};i();let j;const T=()=>{clearTimeout(j),j=setTimeout(i,100)};return window.addEventListener("resize",T),()=>{window.removeEventListener("resize",T),clearTimeout(j)}},[]);const v=c||h,z=a.useMemo(()=>{switch(t){case"es":return Ve.galleryImages;case"en":return _a.galleryImages;case"nah":return Oa.galleryImages;default:return Ve.galleryImages}},[t]),S=a.useRef(null),{selectedImage:A,currentImageIndex:H,selectedCategory:k,viewMode:I,zoomLevel:U,categories:y,filteredImages:M,currentImage:q,setSelectedCategory:G,setViewMode:B,openImage:X,closeImage:E,nextImage:V,prevImage:R,handleZoomIn:K,handleZoomOut:J,handleResetZoom:Q,getCircularPosition:u,isYouTubeModalOpen:D,setIsYouTubeModalOpen:L,isVideoHovered:P,setIsVideoHovered:se,formatDate:_}=Ea(z);a.useEffect(()=>{S.current&&k!=="todas"&&setTimeout(()=>{S.current?.scrollIntoView({behavior:v?"auto":"smooth",block:"start",inline:"nearest"})},100)},[k,v]);const m=i=>{switch(i){case"paisajes":return d("gallery.landscapes");case"naturaleza":return d("gallery.nature");case"cultura":return d("gallery.culture");case"comunidad":return d("gallery.community");case"tradiciones":return d("gallery.traditions");default:return i}},g=()=>{L(!0)},N=i=>{se(i)};return e.jsxs("section",{id:"galeria",className:"py-20 relative overflow-hidden min-h-screen",children:[e.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:"url(https://res.cloudinary.com/dinsl266g/image/upload/v1763074398/fondo-galeria_urye7x.svg)"}}),e.jsx("div",{className:"absolute inset-0 bg-black/45 backdrop-blur-[1px]"}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:[e.jsx("div",{className:"text-center mb-16",children:e.jsxs("h2",{id:"roots-heading",className:"text-5xl lg:text-6xl font-bold font-serif text-gray-200 mb-6",children:[d("gallery.titlePart1")," ",e.jsxs("span",{className:"bg-gradient-to-r from-teal-300 via-blue-400 to-emerald-500 bg-clip-text text-transparent",children:[d("gallery.titlePart2")," "]}),e.jsx("span",{className:"bg-gradient-to-r from-teal-100 via-blue-200 to-emerald-300 bg-clip-text text-transparent",children:d("gallery.titlePart3")})]})}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 items-start",children:[e.jsx("div",{className:"w-full lg:w-64 flex-shrink-0 lg:-ml-4",children:e.jsxs("div",{className:"bg-slate-800/20 backdrop-blur-sm rounded-4xl p-6 border border-slate-700/50 sticky top-8 space-y-6",children:[e.jsx(Ia,{viewMode:I,onViewModeChange:B,isMobile:c,shouldRemoveAnimations:v}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-semibold text-lg mb-4 font-serif",children:d("gallery.categoriesTitle")}),e.jsx("div",{className:"space-y-2",children:y.map(i=>e.jsx("button",{onClick:()=>G(i),className:`w-full text-left px-4 py-3 rounded-xl text-sm font-medium ${k===i?"bg-gradient-to-r from-blue-500 to-emerald-500 text-white shadow-lg":"text-slate-300 hover:text-white hover:bg-slate-700/50 border border-slate-600/50"} ${v?"":"transition-colors duration-300"}`,children:i==="todas"?`ðŸŒ„ ${d("gallery.allCategories")}`:`${i==="paisajes"?"ðŸ”ï¸ ":i==="naturaleza"?"ðŸŒ¿ ":i==="cultura"?"ðŸŽ¨ ":i==="comunidad"?"ðŸ‘¥ ":i==="tradiciones"?"ðŸ“œ ":"ðŸ“¸ "}${m(i)}`},i))})]}),e.jsxs("div",{className:"pt-4 border-t border-slate-700/50",children:[e.jsxs("p",{className:"text-slate-400 text-sm",children:[M.length," ",M.length===1?d("gallery.imagesCount"):d("gallery.imagesCount_plural")]}),e.jsxs("p",{className:"text-slate-500 text-xs mt-1",children:[d("gallery.categoryLabel")," ",k==="todas"?d("gallery.allCategoriesLabel"):m(k)]})]})]})}),e.jsxs("div",{ref:S,className:"flex-1 w-full min-w-0",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsx("div",{className:"w-0 lg:w-32"}),e.jsx("div",{className:"w-0 lg:w-32"})]}),e.jsx("div",{className:"relative",children:e.jsxs("div",{className:`relative w-full mx-auto ${I==="grid"?"flex flex-col":"flex items-center justify-center min-h-[75vh]"}`,children:[e.jsx("div",{className:`
                  ${I==="grid"?"w-full mb-6":"relative z-10"}
                `,children:e.jsx("div",{className:`
                    ${I==="grid"?"w-full max-w-4xl mx-auto h-[350px] md:h-[450px] rounded-2xl overflow-hidden":"w-44 h-44 md:w-52 md:h-52 rounded-2xl overflow-hidden"}
                  `,children:e.jsx(ka,{isGridMode:I==="grid",onVideoClick:g,isVideoHovered:P,onVideoHover:N,shouldRemoveAnimations:v})})}),I==="circular"&&M.length>0&&e.jsx("div",{className:`absolute inset-0 ${c?"scale-90":"scale-100"}`,children:e.jsx(Ma,{images:M,getCircularPosition:u,onImageClick:X,isMobile:c,shouldRemoveAnimations:v})}),I==="grid"&&M.length>0&&e.jsx("div",{className:"w-full max-w-4xl mx-auto",children:e.jsx(Sa,{images:M,onImageClick:X,isMobile:c,shouldRemoveAnimations:v})})]})}),e.jsx("div",{className:"text-center mt-12",children:e.jsxs("div",{className:"bg-gradient-to-r from-yellow-800 to-amber-900 rounded-3xl p-8 border border-slate-700/50 shadow-2xl",children:[e.jsx("h3",{className:"text-2xl md:text-3xl font-bold text-white mb-4 font-serif",children:d("gallery.communityCallToAction")}),e.jsx("p",{className:"text-slate-300 text-lg mb-6 max-w-2xl mx-auto",children:d("gallery.communityDescription")})]})})]})]}),e.jsx(za,{isOpen:!!A,onClose:E,image:q,currentIndex:H,totalImages:M.length,zoomLevel:U,onNext:V,onPrev:R,onZoomIn:K,onZoomOut:J,onResetZoom:Q,formatDate:_,shouldRemoveAnimations:v}),e.jsx(Ta,{isOpen:D,onClose:()=>L(!1),videoId:"4r2isHLCNFo",shouldRemoveAnimations:v})]})]})}const Ua=()=>{const[t,d]=a.useState([]),[c,l]=a.useState([]),[h,x]=a.useState(!1),[v,z]=a.useState(!1),[S,A]=a.useState(null),[H,k]=a.useState(null),[I,U]=a.useState(null),[y,M]=a.useState(null),[q,G]=a.useState(!1),[B,X]=a.useState(!1),[E,V]=a.useState({pagina:1,totalPaginas:1,total:0,tieneMas:!1}),[R,K]=a.useState(!1),[J,Q]=a.useState(!0),{toast:u}=Ae(),D=a.useRef(!1),L=a.useCallback(async r=>{try{if(G(!0),!r.trim())return{esAprobado:!1,motivo:"Texto requerido"};const s=await ee.post("/api/experiencias/moderacion/validar-texto",{texto:r.trim()});return s.data.success?{esAprobado:s.data.esAprobado??!0,motivo:s.data.motivo,detalles:s.data.detalles}:{esAprobado:!1,motivo:s.data.mensaje||"Error en validaciÃ³n"}}catch(s){const n=s;if(n.response?.data&&"error"in n.response.data&&(n.response.data.error==="TEXTO_RECHAZADO"||n.response.data.error==="CONTENIDO_RECHAZADO"||n.response.data.error==="NOMBRE_USUARIO_RECHAZADO")){const f=n.response.data;return{esAprobado:!1,motivo:f.motivo,detalles:f.detalles}}return{esAprobado:!1,motivo:n.response?.data?.message||n.message||"Error validando texto"}}finally{G(!1)}},[]),P=a.useCallback(async r=>{try{return X(!0),r.trim().length>50?{esAprobado:!1,motivo:"El nombre de usuario no puede exceder los 50 caracteres"}:r.trim().length<2&&r.trim().length>0?{esAprobado:!1,motivo:"El nombre de usuario debe tener al menos 2 caracteres"}:r.trim()?await L(r):{esAprobado:!0}}catch(s){return console.error("Error validando nombre de usuario:",s),{esAprobado:!1,motivo:"Error al validar nombre de usuario"}}finally{X(!1)}},[L]),se=a.useCallback(async r=>{const s=await L(r);return!s.esAprobado&&s.motivo&&u({title:"âŒ Texto no aprobado",description:s.motivo,variant:"destructive",duration:8e3}),s},[u,L]),_=a.useCallback((r,s="texto")=>{if(!r.esAprobado&&r.motivo){const n=r.detalles?.problemas,p=n&&n.length>0,f=s==="nombre_usuario"?"âŒ Nombre de usuario no aprobado":"âŒ Contenido no aprobado",b=p?`${r.motivo}

Problemas detectados:
â€¢ ${n.join(`
â€¢ `)}`:r.motivo;u({title:f,description:b,variant:"destructive",duration:1e4})}},[u]),m=a.useCallback(async r=>{try{const s={};return r&&(s.hash_navegador=r),(await ee.get("/api/experiencias/moderacion/motivos-rechazo",{params:s})).data.motivos||[]}catch(s){return console.error("Error obteniendo motivos de rechazo:",s),[]}},[]),g=a.useCallback(r=>{const s=r;if(s?.response?.status===429){const n=s.response.data?.detalles;return typeof n=="string"?n:"LÃ­mite diario alcanzado"}if(s?.response?.data&&"error"in s.response.data&&(s.response.data.error==="CONTENIDO_RECHAZADO"||s.response.data.error==="TEXTO_RECHAZADO"||s.response.data.error==="NOMBRE_USUARIO_RECHAZADO")){const n=s.response.data;return n.motivo||n.message}return s?.response?.data?.error?s.response.data.error:s?.response?.data?.message?s.response.data.message:s?.message?s.message:"Error desconocido al procesar la solicitud"},[]),N=a.useCallback(r=>{if(!r)return"/placeholder-experience.jpg";if(r.startsWith("http"))return r;const s="https://backend-production-956f.up.railway.app",n=r.startsWith("/")?r:`/${r}`;return`${s}${n}`},[]),i=a.useCallback(async r=>{if(!D.current){D.current=!0;try{r?.cargarMas?K(!0):x(!0),M(null);const s=new URLSearchParams,n=r?.pagina||1,p=r?.limite||6;s.append("pagina",n.toString()),s.append("limite",p.toString()),r?.lugar_id&&s.append("lugar_id",r.lugar_id);const f=await ee.get(`/api/experiencias?${s}`),w=(f.data.experiencias||[]).map(W=>({...W,url_foto:N(W.url_foto)}));r?.cargarMas?d(W=>[...W,...w]):d(w);const O={pagina:f.data.pagina,totalPaginas:f.data.totalPaginas,total:f.data.total,tieneMas:f.data.pagina<f.data.totalPaginas};return V(O),{experiencias:w,total:f.data.total,pagina:f.data.pagina,totalPaginas:f.data.totalPaginas,tieneMas:f.data.pagina<f.data.totalPaginas}}catch(s){const n=g(s);throw M(n),u({title:"Error",description:n,variant:"destructive"}),new Error(n)}finally{x(!1),K(!1),D.current=!1}}},[u,N,g]),j=a.useCallback(async()=>{try{x(!0);const n=((await ee.get("/api/experiencias/usuario/mis-experiencias")).data.experiencias||[]).map(p=>({...p,url_foto:N(p.url_foto)}));return l(n),n}catch(r){const s=g(r);return console.error("Error obteniendo mis experiencias:",s),u({title:"Error",description:"No se pudieron cargar tus experiencias",variant:"destructive"}),[]}finally{x(!1)}},[u,N,g]),T=a.useCallback(async(r,s,n,p)=>{try{if(z(!0),!(localStorage.getItem("experience_terms_accepted")==="true"))return{success:!1,necesitaTerminos:!0};if(s.trim().length===0)return u({title:"Error",description:"La descripciÃ³n no puede estar vacÃ­a",variant:"destructive"}),{success:!1,error:"La descripciÃ³n no puede estar vacÃ­a"};if(s.trim().length>500)return u({title:"Error",description:"La descripciÃ³n no puede exceder los 500 caracteres",variant:"destructive"}),{success:!1,error:"La descripciÃ³n no puede exceder los 500 caracteres"};if(p&&p.trim()){const W=await P(p);if(!W.esAprobado)return _(W,"nombre_usuario"),{success:!1,error:W.motivo}}console.log("ðŸ” Validando texto antes de subir archivo...");const b=await L(s);if(!b.esAprobado)return console.log("âŒ Texto rechazado por moderaciÃ³n:",b.motivo),_(b),{success:!1,error:b.motivo};console.log("âœ… Texto aprobado, procediendo con subida de archivo...");const w=new FormData;w.append("imagen",r),w.append("descripcion",s.trim()),n&&w.append("lugar_id",n),p!==void 0&&w.append("nombre_usuario",p.trim());const O=await ee.post("/api/experiencias",w,{headers:{"Content-Type":"multipart/form-data"}});if(!O.data.success)throw new Error(O.data.mensaje||"Error al subir experiencia");return await j(),await i({pagina:1,limite:6}),u({title:"âœ… Experiencia publicada",description:O.data.mensaje,variant:"default"}),{success:!0}}catch(f){const b=f;if(b.response?.data&&typeof b.response.data=="object"){const O=b.response.data;if("error"in O&&(O.error==="CONTENIDO_RECHAZADO"||O.error==="TEXTO_RECHAZADO"||O.error==="NOMBRE_USUARIO_RECHAZADO")){const W=O,Ne=O.error==="NOMBRE_USUARIO_RECHAZADO"?"nombre_usuario":"texto";return _({esAprobado:!1,motivo:W.motivo,detalles:W.detalles},Ne),{success:!1,error:W.motivo}}else if("message"in O){const W=O.message||g(f);return u({title:"âŒ Error al subir experiencia",description:W,variant:"destructive"}),{success:!1,error:W}}}const w=g(f);return u({title:"âŒ Error al subir experiencia",description:w,variant:"destructive"}),{success:!1,error:w}}finally{z(!1)}},[u,j,i,g,L,P,_]),$=a.useCallback(async(r,s,n,p)=>{const f=await T(r,s,n,p);if(f.necesitaTerminos)throw new Error("TERMS_REQUIRED");return f.success},[T]),re=a.useCallback(async(r,s)=>{try{if(U(r),s.trim().length>50)return u({title:"Error",description:"El nombre de usuario no puede exceder los 50 caracteres",variant:"destructive"}),!1;const n=await P(s);if(!n.esAprobado)return _(n,"nombre_usuario"),!1;const p=await ee.put(`/api/experiencias/${r}/nombre-usuario`,{nombre_usuario:s.trim()});if(!p.data.success)throw new Error(p.data.mensaje||"Error al actualizar nombre de usuario");return await j(),await i({pagina:1,limite:6}),u({title:"âœ… Nombre actualizado",description:p.data.mensaje,variant:"default"}),!0}catch(n){const p=g(n);return u({title:"âŒ Error al actualizar nombre",description:p,variant:"destructive"}),!1}finally{U(null)}},[u,j,i,g,P,_]),ae=a.useCallback(async()=>{if(R||!E.tieneMas)return;const r=E.pagina+1;await i({pagina:r,limite:6,cargarMas:!0})},[R,E,i]),ne=a.useCallback(()=>{Q(!0)},[]),te=a.useCallback(()=>{Q(!1)},[]),ce=a.useCallback(async(r,s,n,p)=>{try{if(A(r),s.trim().length===0)return u({title:"Error",description:"La descripciÃ³n no puede estar vacÃ­a",variant:"destructive"}),!1;if(s.trim().length>500)return u({title:"Error",description:"La descripciÃ³n no puede exceder los 500 caracteres",variant:"destructive"}),!1;if(p!==void 0){const b=await P(p);if(!b.esAprobado)return _(b,"nombre_usuario"),!1}const f=await L(s);if(!f.esAprobado)return _(f),!1;if(n){console.log("ðŸ”„ Editando experiencia CON nueva imagen");const b=new FormData;b.append("descripcion",s.trim()),b.append("imagen",n),p!==void 0&&b.append("nombre_usuario",p.trim());const w=await ee.put(`/api/experiencias/${r}/con-imagen`,b,{headers:{"Content-Type":"multipart/form-data"}});if(!w.data.success)throw new Error(w.data.mensaje||"Error al editar experiencia con imagen");return await j(),await i({pagina:1,limite:6}),u({title:"âœ… Experiencia actualizada",description:w.data.mensaje,variant:"default"}),!0}else{console.log("ðŸ”„ Editando experiencia SIN nueva imagen");const b={descripcion:s.trim()};p!==void 0&&(b.nombre_usuario=p.trim());const w=await ee.put(`/api/experiencias/${r}`,b);if(!w.data.success)throw new Error(w.data.mensaje||"Error al editar experiencia");return await j(),await i({pagina:1,limite:6}),u({title:"âœ… Experiencia actualizada",description:"Tu experiencia ha sido actualizada exitosamente.",variant:"default"}),!0}}catch(f){const b=f;if(b.response?.data&&typeof b.response.data=="object"){const w=b.response.data;if("error"in w&&(w.error==="CONTENIDO_RECHAZADO"||w.error==="NOMBRE_USUARIO_RECHAZADO")){const O=w,W=w.error==="NOMBRE_USUARIO_RECHAZADO"?"nombre_usuario":"texto";_({esAprobado:!1,motivo:O.motivo,detalles:O.detalles},W)}else if("message"in w){const O=w.message||g(f);u({title:"âŒ Error al editar experiencia",description:O,variant:"destructive"})}}else{const w=g(f);u({title:"âŒ Error al editar experiencia",description:w,variant:"destructive"})}return!1}finally{A(null)}},[u,j,i,g,L,P,_]),he=a.useCallback(async r=>{try{x(!0);const n=(await ee.get(`/api/experiencias/${r}`)).data.experiencia;return{...n,url_foto:N(n.url_foto)}}catch(s){const n=g(s);return u({title:"Error",description:n,variant:"destructive"}),null}finally{x(!1)}},[u,N,g]),oe=a.useCallback(async(r,s,n)=>{try{if(A(r),s.trim().length===0)return u({title:"Error",description:"La descripciÃ³n no puede estar vacÃ­a",variant:"destructive"}),!1;if(s.trim().length>500)return u({title:"Error",description:"La descripciÃ³n no puede exceder los 500 caracteres",variant:"destructive"}),!1;if(n!==void 0){const b=await P(n);if(!b.esAprobado)return _(b,"nombre_usuario"),!1}const p=await L(s);if(!p.esAprobado)return _(p),!1;const f={descripcion:s.trim()};return n!==void 0&&(f.nombre_usuario=n.trim()),await ee.put(`/api/experiencias/${r}`,f),await j(),u({title:"âœ… Experiencia actualizada",description:"Tu experiencia ha sido actualizada exitosamente.",variant:"default"}),!0}catch(p){const f=p;if(f.response?.data&&typeof f.response.data=="object"){const b=f.response.data;if("error"in b&&(b.error==="CONTENIDO_RECHAZADO"||b.error==="NOMBRE_USUARIO_RECHAZADO")){const w=b,O=b.error==="NOMBRE_USUARIO_RECHAZADO"?"nombre_usuario":"texto";_({esAprobado:!1,motivo:w.motivo,detalles:w.detalles},O)}else if("message"in b){const w=b.message||g(p);u({title:"âŒ Error al editar experiencia",description:w,variant:"destructive"})}}else{const b=g(p);u({title:"âŒ Error al editar experiencia",description:b,variant:"destructive"})}return!1}finally{A(null)}},[u,j,g,L,P,_]),ie=a.useCallback(async r=>{try{return k(r),await ee.delete(`/api/experiencias/${r}`),await j(),u({title:"âœ… Experiencia eliminada",description:"Tu experiencia ha sido eliminada exitosamente.",variant:"default"}),!0}catch(s){const n=g(s);return u({title:"âŒ Error al eliminar experiencia",description:n,variant:"destructive"}),!1}finally{k(null)}},[u,j,g]),we=a.useCallback(async r=>{try{console.log("ðŸ‘€ Incrementando vista para experiencia:",r);const s=await ee.post(`/api/experiencias/${r}/vista`);return console.log("âœ… Respuesta vista:",s.data.tipo),s.data.tipo==="nueva_vista"&&(d(n=>n.map(p=>p.id===r?{...p,contador_vistas:p.contador_vistas+1}:p)),l(n=>n.map(p=>p.id===r?{...p,contador_vistas:p.contador_vistas+1}:p))),{success:!0,isNewView:s.data.tipo==="nueva_vista",message:s.data.mensaje}}catch(s){return console.error("âŒ Error incrementando vista:",s),{success:!1,message:g(s)}}},[g]),xe=a.useCallback(r=>{const s={...r,url_foto:N(r.url_foto)};d(n=>n.map(p=>p.id===r.id?s:p)),l(n=>n.map(p=>p.id===r.id?s:p))},[N]),F=a.useCallback(r=>{const s={...r,url_foto:N(r.url_foto)};d(n=>[s,...n]),l(n=>[s,...n])},[N]),le=a.useCallback(async()=>{try{return(await ee.get("/api/experiencias/admin/estadisticas")).data}catch(r){return console.error("Error obteniendo estadÃ­sticas:",r),null}},[]),ye=a.useCallback(async()=>{try{await i(),c.length>0&&await j()}catch(r){console.error("Error en reevaluaciÃ³n automÃ¡tica:",r)}},[i,j,c.length]);return a.useEffect(()=>{if(!J)return;const r=setInterval(async()=>{try{D.current||(await i({pagina:1,limite:6}),console.log("ðŸ”„ ActualizaciÃ³n automÃ¡tica de experiencias"))}catch(s){console.error("Error en actualizaciÃ³n automÃ¡tica:",s)}},1e4);return()=>clearInterval(r)},[J,i]),{experiences:t,myExperiences:c,loading:h,uploading:v,editing:S,deleting:H,editingUserName:I,error:y,pagination:E,loadingMore:R,autoRefresh:J,validandoTexto:q,validandoNombreUsuario:B,validarTexto:se,validarTextoSilencioso:L,validarTextoRapido:L,validarNombreUsuario:P,obtenerMotivosRechazo:m,mostrarToastRechazo:_,fetchExperiences:i,fetchMyExperiences:j,fetchExperienceById:he,uploadExperience:$,uploadExperienceWithValidation:T,editExperience:oe,deleteExperience:ie,incrementViewCount:we,editExperienceWithImage:ce,editUserName:re,getExperienceStats:le,updateExperience:xe,addNewExperience:F,loadMoreExperiences:ae,startAutoRefresh:ne,stopAutoRefresh:te,reevaluateExperiences:ye,refetch:i,resetError:()=>M(null),isUploading:v,isEditing:r=>S===r,isDeleting:r=>H===r,isEditingUserName:r=>I===r}},Fe=100,Pa=({experience:t,isOpen:d,onClose:c})=>{const[l,h]=a.useState(1),[x,v]=a.useState(0),[z,S]=a.useState(!1),[A,H]=a.useState({x:0,y:0}),[k,I]=a.useState({x:0,y:0}),[U,y]=a.useState(!0),M=a.useRef({x:0,y:0,time:0}),q=a.useRef({x:0,y:0,time:0}),G=a.useRef(null);a.useEffect(()=>{if(d&&t){h(1),v(0),I({x:0,y:0}),y(!0);const m=setTimeout(()=>{y(!1)},3e3);return()=>clearTimeout(m)}},[d,t]),a.useEffect(()=>{if(t){y(!0);const m=setTimeout(()=>{y(!1)},2e3);return()=>clearTimeout(m)}},[t]);const B=a.useCallback(()=>{h(m=>Math.min(m+.25,3))},[]),X=a.useCallback(()=>{h(m=>Math.max(m-.25,1))},[]),E=a.useCallback(()=>{v(m=>(m+90)%360)},[]),V=a.useCallback(()=>{h(1),v(0),I({x:0,y:0})},[]);a.useEffect(()=>{const m=g=>{if(!(!d||!t))switch(g.key){case"Escape":c();break;case"+":case"=":B();break;case"-":X();break;case"r":case"R":E();break;case"0":V();break;case" ":y(N=>!N);break}};return document.addEventListener("keydown",m),()=>document.removeEventListener("keydown",m)},[d,t,c,B,X,E,V]);const R=a.useCallback(m=>{if(l>1)return;const g=m.touches[0];M.current={x:g.clientX,y:g.clientY,time:Date.now()}},[l]),K=a.useCallback(m=>{if(l>1)return;const g=m.touches[0];q.current={x:g.clientX,y:g.clientY,time:Date.now()}},[l]),J=a.useCallback(()=>{if(l>1)return;const{x:m,y:g}=M.current,{x:N,y:i}=q.current,j=N-m,T=i-g;if(q.current.time-M.current.time>300)return;const re=Math.abs(j),ae=Math.abs(T);T>Fe&&ae>re&&c()},[l,c]),Q=a.useCallback(m=>{l<=1?(M.current={x:m.clientX,y:m.clientY,time:Date.now()},S(!0)):(S(!0),H({x:m.clientX-k.x,y:m.clientY-k.y}))},[l,k.x,k.y]),u=a.useCallback(m=>{if(z)if(l<=1)q.current={x:m.clientX,y:m.clientY,time:Date.now()};else{const g=m.clientX-A.x,N=m.clientY-A.y,i=(l-1)*100;I({x:Math.max(Math.min(g,i),-i),y:Math.max(Math.min(N,i),-i)})}},[z,l,A.x,A.y]),D=a.useCallback(()=>{if(z){if(l<=1){const{x:m,y:g}=M.current,{x:N,y:i}=q.current,j=N-m,T=i-g,$=Math.abs(j),re=Math.abs(T);T>Fe&&re>$&&c()}S(!1)}},[z,l,c]),L=a.useCallback(()=>{if(!t)return;const m=document.createElement("a");m.href=t.url_foto,m.download=`experiencia-${t.id}.jpg`,document.body.appendChild(m),m.click(),document.body.removeChild(m)},[t]),P=a.useCallback(()=>{y(m=>!m)},[]),se=a.useCallback(m=>{m.target===m.currentTarget&&c()},[c]),_=a.useCallback(m=>new Date(m).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}),[]);return!d||!t?null:e.jsxs("div",{ref:G,className:"fixed inset-0 bg-black/95 z-50 flex items-center justify-center p-4 touch-none",onClick:se,children:[U&&e.jsx("button",{onClick:c,className:"absolute top-4 right-4 text-white hover:text-gray-300 transition-colors z-40 bg-black/50 rounded-full p-2 backdrop-blur-sm",children:e.jsx(ve,{className:"w-8 h-8"})}),U&&e.jsxs("div",{className:"absolute top-4 left-4 z-40 flex items-center gap-2 bg-black/50 rounded-lg p-3 backdrop-blur-sm",children:[e.jsx(Y,{variant:"ghost",size:"icon",onClick:L,className:"text-white hover:bg-white/20",title:"Descargar imagen",children:e.jsx(ha,{className:"w-4 h-4"})}),e.jsx(Y,{variant:"ghost",size:"icon",onClick:E,className:"text-white hover:bg-white/20",title:"Rotar imagen (R)",children:e.jsx(He,{className:"w-4 h-4"})}),e.jsx(Y,{variant:"ghost",size:"icon",onClick:X,disabled:l<=1,className:"text-white hover:bg-white/20 disabled:opacity-50",title:"Zoom out (-)",children:e.jsx(Ze,{className:"w-4 h-4"})}),e.jsx(Y,{variant:"ghost",size:"icon",onClick:B,disabled:l>=3,className:"text-white hover:bg-white/20 disabled:opacity-50",title:"Zoom in (+)",children:e.jsx(Ge,{className:"w-4 h-4"})}),e.jsx(Y,{variant:"ghost",size:"icon",onClick:V,disabled:l===1&&x===0,className:"text-white hover:bg-white/20 disabled:opacity-50",title:"Reset transformaciÃ³n (0)",children:e.jsx("span",{className:"text-sm",children:"âŸ²"})})]}),e.jsx("div",{className:"relative max-w-full max-h-full flex items-center justify-center",onDoubleClick:P,onTouchStart:R,onTouchMove:K,onTouchEnd:J,onMouseDown:Q,onMouseMove:u,onMouseUp:D,onMouseLeave:D,children:e.jsx("div",{className:Ue("relative transition-transform duration-200",z&&l<=1?"cursor-grabbing":l>1?"cursor-grab":"cursor-default"),style:{transform:`scale(${l}) rotate(${x}deg) translate(${k.x}px, ${k.y}px)`,transformOrigin:"center center"},children:e.jsx("img",{src:t.url_foto,alt:t.descripcion,className:"max-w-screen max-h-screen object-contain rounded-lg shadow-lg select-none",draggable:!1})})}),U&&e.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 z-40 max-w-2xl w-full px-4",children:e.jsxs("div",{className:"bg-black/70 backdrop-blur-sm text-white p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:Ue("w-3 h-3 rounded-full",t.estado==="aprobado"?"bg-green-500":t.estado==="pendiente"?"bg-yellow-500":"bg-red-500")}),e.jsx("span",{className:"text-sm font-medium capitalize",children:t.estado||"aprobado"})]}),(l!==1||x!==0)&&e.jsxs("div",{className:"flex gap-4 text-xs text-gray-300",children:[l>1&&e.jsxs("span",{children:["Zoom: ",l.toFixed(1),"x"]}),x!==0&&e.jsxs("span",{children:["RotaciÃ³n: ",x,"Â°"]})]})]}),e.jsx("p",{className:"text-lg leading-relaxed mb-3",children:t.descripcion}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-300",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(_e,{className:"w-4 h-4"}),e.jsx("span",{children:_(t.creado_en)})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ye,{className:"w-4 h-4"}),e.jsxs("span",{children:[t.contador_vistas," vistas"]})]}),t.lugar_nombre&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(De,{className:"w-4 h-4"}),e.jsx("span",{children:t.lugar_nombre})]}),t.nombre_usuario&&e.jsx("div",{className:"flex items-center gap-1 text-blue-300",children:e.jsxs("span",{children:["Por: ",t.nombre_usuario]})})]})]})}),!U&&e.jsx("div",{className:"absolute top-20 left-1/2 transform -translate-x-1/2 z-40 bg-black/70 text-white px-4 py-2 rounded-lg text-sm backdrop-blur-sm text-center",children:e.jsx("p",{children:"â†“ Desliza abajo para cerrar"})}),U&&e.jsxs("div",{className:"absolute top-20 left-1/2 transform -translate-x-1/2 z-40 bg-black/70 text-white px-4 py-2 rounded-lg text-sm backdrop-blur-sm text-center",children:[e.jsx("p",{children:"Doble clic para controles â€¢ Espacio para mostrar/ocultar â€¢ ESC para salir"}),e.jsx("p",{className:"text-xs mt-1",children:"Click fuera para cerrar â€¢ Desliza abajo (mÃ³vil)"})]})]})},ke=({variant:t="default",className:d="",children:c})=>{const l="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",h={default:"bg-blue-100 text-blue-800",outline:"border bg-transparent",secondary:"bg-gray-100 text-gray-800",destructive:"bg-red-100 text-red-800"};return e.jsx("span",{className:`${l} ${h[t]} ${d}`,children:c})},$a=({nombreUsuario:t,className:d=""})=>{const c=t?.trim()||"Usuario AnÃ³nimo",l=!t?.trim();return e.jsxs("div",{className:`flex items-center gap-2 ${d}`,children:[l?e.jsx(va,{className:"w-4 h-4 text-gray-500"}):e.jsx(ya,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:`text-sm font-medium ${l?"text-gray-500":"text-gray-700"}`,children:c})]})},Te=({modelo:t,cargando:d,errorModelo:c})=>d?e.jsxs(ke,{variant:"outline",className:"text-yellow-400 border-yellow-400 text-xs",children:[e.jsx(de,{className:"h-3 w-3 animate-spin mr-1"}),"Cargando modelo..."]}):t?e.jsxs(ke,{variant:"outline",className:"text-green-400 border-green-400 text-xs",children:[e.jsx(qe,{className:"h-3 w-3 mr-1"}),"ModeraciÃ³n activa"]}):c?e.jsxs(ke,{variant:"outline",className:"text-red-400 border-red-400 text-xs",children:[e.jsx(qe,{className:"h-3 w-3 mr-1"}),"Error en modelo"]}):null,qa=({loading:t,hasMore:d,onClick:c})=>d?e.jsx("div",{className:"flex justify-center mt-8",children:e.jsx(Y,{onClick:c,disabled:t,variant:"outline",className:"px-8 py-3 border-blue-600 text-blue-600 hover:bg-blue-50",children:t?e.jsxs(e.Fragment,{children:[e.jsx(ja,{className:"w-4 h-4 mr-2 animate-spin"}),"Cargando..."]}):"Ver mÃ¡s experiencias"})}):null,We=({count:t})=>e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:t}).map((d,c)=>e.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl overflow-hidden shadow-card border border-white/20",children:[e.jsx(me,{className:"w-full h-64"}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsx(me,{className:"h-4 w-3/4"}),e.jsx(me,{className:"h-4 w-full"}),e.jsx(me,{className:"h-4 w-2/3"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(me,{className:"h-6 w-20"}),e.jsx(me,{className:"h-6 w-16"})]})]})]},c))}),Va=({activeTab:t,onUploadClick:d,isCommunityEmpty:c})=>t==="comunidad"&&c?e.jsx(Z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-16 bg-white/80 backdrop-blur-sm rounded-3xl border border-white/30 shadow-2xl",children:e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsx("div",{className:"w-24 h-24 mx-auto mb-6 bg-gradient-to-br from-blue-100 to-green-100 rounded-full flex items-center justify-center",children:e.jsx(fa,{className:"w-12 h-12 text-blue-500"})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-3",children:"Â¡SÃ© el Primero!"}),e.jsx("p",{className:"text-gray-600 mb-6 text-lg",children:"AÃºn no hay experiencias compartidas en la comunidad. SÃ© el primero en inspirar a otros con tu aventura."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Y,{onClick:d,className:"bg-gradient-to-r from-blue-600 to-green-600 hover:from-blue-700 hover:to-green-700 text-white font-semibold py-3 px-8 rounded-xl shadow-lg",children:[e.jsx(Me,{className:"w-5 h-5 mr-2"}),"Compartir Mi Primera Experiencia"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"ðŸ“¸ Comparte fotos â€¢ ðŸ’¬ Cuenta tu historia â€¢ ðŸŒŸ Inspira a la comunidad"})]})]})}):e.jsx(Z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-16 bg-white/80 backdrop-blur-sm rounded-3xl border border-white/30 shadow-2xl",children:e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsx("div",{className:"w-24 h-24 mx-auto mb-6 bg-gradient-to-br from-purple-100 to-pink-100 rounded-full flex items-center justify-center",children:e.jsx(Me,{className:"w-12 h-12 text-purple-500"})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-3",children:t==="mis-experiencias"?"Comienza Tu Historia":"Explora Experiencias"}),e.jsx("p",{className:"text-gray-600 mb-6 text-lg",children:t==="mis-experiencias"?"Comparte tu primera experiencia y forma parte de nuestra comunidad viajera.":"Descubre las historias y momentos compartidos por otros aventureros."}),e.jsxs(Y,{onClick:d,className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-semibold py-3 px-8 rounded-xl shadow-lg",children:[e.jsx(Be,{className:"w-5 h-5 mr-2"}),t==="mis-experiencias"?"Compartir Mi Experiencia":"Ver Todas las Experiencias"]})]})}),Fa=({myExperiences:t})=>{if(t.length===0)return null;const d=t.reduce((x,v)=>x+v.contador_vistas,0),c=t.length>0?Math.round(d/t.length):0,l=t.filter(x=>x.nombre_usuario?.trim()).length,h=t.length>0?Math.round(l/t.length*100):0;return e.jsxs(Z.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-gradient-to-r from-blue-50/80 to-green-50/80 backdrop-blur-sm rounded-xl p-4 mb-6 border border-white/30",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Mis EstadÃ­sticas"}),e.jsxs("div",{className:"flex flex-wrap gap-4 justify-center md:justify-start",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Experiencias"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:d}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Vistas"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:c}),e.jsx("div",{className:"text-sm text-gray-600",children:"Vistas/Promedio"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-indigo-600",children:[h,"%"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Con Nombre"})]})]})]})},Wa=({experience:t,isOpen:d,onClose:c,onSave:l,onSaveWithImage:h,loading:x,modelo:v,cargandoModelo:z,errorModelo:S,analizarImagen:A})=>{const[H,k]=a.useState(""),[I,U]=a.useState(""),[y,M]=a.useState(null),[q,G]=a.useState(null),[B,X]=a.useState(!1),E=a.useRef(null),{toast:V}=Ae();a.useEffect(()=>{t&&(k(t.descripcion),U(t.nombre_usuario||""),G(null),M(null),X(!1))},[t]);const R=async u=>{if(!u.type.startsWith("image/")){V({title:"Tipo de archivo invÃ¡lido",description:"Por favor selecciona solo archivos de imagen.",variant:"destructive"});return}if(u.size>5*1024*1024){V({title:"Archivo muy grande",description:"La imagen no debe superar los 5MB.",variant:"destructive"});return}try{X(!0);const D=await A(u);if(!D.esAprobado){V({title:"âŒ Imagen rechazada",description:D.razon||"La imagen no cumple con los criterios de contenido apropiado.",variant:"destructive"});return}V({title:"âœ… Imagen aprobada",description:"La imagen ha pasado el filtro de moderaciÃ³n",variant:"default"}),M(u),G(URL.createObjectURL(u))}catch(D){console.error("Error analizando imagen:",D),V({title:"âš ï¸ Advertencia",description:"No se pudo analizar la imagen. Se usarÃ¡ sin verificaciÃ³n.",variant:"default"}),M(u),G(URL.createObjectURL(u))}finally{X(!1)}},K=u=>{const D=u.target.files?.[0];D&&R(D)},J=()=>{M(null),G(null),E.current&&(E.current.value="")},Q=()=>{y?h(H,y,I):l(H,I)};return t?e.jsx(be,{open:d,onOpenChange:c,children:e.jsxs(fe,{className:"max-w-2xl bg-slate-900/95 backdrop-blur-sm border border-slate-700 shadow-xl text-white",children:[e.jsxs(Se,{children:[e.jsx(ze,{children:"Editar Experiencia"}),e.jsx(Ie,{className:"text-gray-300",children:"Modifica la descripciÃ³n, nombre de usuario o cambia la imagen de tu experiencia"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Tu nombre (opcional)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Je,{className:"w-4 h-4 text-gray-400"}),e.jsx(je,{placeholder:"CÃ³mo quieres que te llamen (mÃ¡x. 50 caracteres)",value:I,onChange:u=>U(u.target.value),maxLength:50,className:"bg-white/10 border-white/20 text-white placeholder-gray-400"})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:'ðŸ’¡ Si dejas este campo vacÃ­o, se mostrarÃ¡ como "Usuario AnÃ³nimo"'})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"block text-sm font-medium text-white",children:"Imagen de la experiencia"}),e.jsx(Te,{modelo:!!v,cargando:z,errorModelo:S})]}),e.jsxs("div",{className:"flex gap-4 items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-300 mb-2",children:"Imagen actual:"}),e.jsx("img",{src:t.url_foto,alt:"Experiencia actual",className:"w-32 h-32 object-cover rounded-lg border border-gray-600"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-300 mb-2",children:"Nueva imagen (opcional):"}),B?e.jsxs("div",{className:"w-32 h-32 border-2 border-dashed border-yellow-400 rounded-lg flex flex-col items-center justify-center bg-yellow-400/10",children:[e.jsx(de,{className:"w-6 h-6 text-yellow-400 animate-spin mb-2"}),e.jsx("p",{className:"text-xs text-yellow-400 text-center",children:"Analizando imagen..."})]}):q?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:q,alt:"Nueva imagen",className:"w-32 h-32 object-cover rounded-lg border border-blue-400"}),e.jsx("button",{onClick:J,className:"absolute -top-2 -right-2 p-1 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors",children:e.jsx(ve,{className:"w-3 h-3"})})]}):e.jsx("div",{onClick:()=>E.current?.click(),className:"w-32 h-32 border-2 border-dashed border-gray-600 rounded-lg flex items-center justify-center cursor-pointer hover:border-gray-500 transition-colors",children:e.jsx(Ke,{className:"w-6 h-6 text-gray-400"})}),e.jsx(je,{ref:E,type:"file",accept:"image/*",onChange:K,className:"hidden",disabled:B}),y&&e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:y.name})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"ðŸ’¡ Al cambiar la imagen, la nueva serÃ¡ analizada por moderaciÃ³n automÃ¡tica"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"DescripciÃ³n *"}),e.jsx(Qe,{placeholder:"Describe tu experiencia...",value:H,onChange:u=>k(u.target.value),rows:4,className:"bg-white/10 border-white/20 text-white placeholder-gray-400"})]}),e.jsx("div",{className:"bg-gray-800/50 rounded-lg p-3",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"Publicado el"}),e.jsx("p",{className:"text-white",children:new Date(t.creado_en).toLocaleDateString("es-ES")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"Vistas"}),e.jsx("p",{className:"text-white",children:t.contador_vistas})]})]})}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(Y,{variant:"outline",onClick:c,disabled:x||B,className:"flex-1 hover:bg-gray-800 text-white border-gray-600",children:"Cancelar"}),e.jsx(Y,{onClick:Q,disabled:!H.trim()||x||B,className:"flex-1 bg-blue-600 hover:bg-blue-700",children:x?e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"w-4 h-4 animate-spin mr-2"}),y?"Actualizando...":"Guardando..."]}):y?"Actualizar con nueva imagen":"Guardar Cambios"})]})]})]})}):null},Za=()=>{const{experiences:t,myExperiences:d,loading:c,uploading:l,editing:h,deleting:x,pagination:v,loadingMore:z,autoRefresh:S,uploadExperienceWithValidation:A,editExperience:H,editExperienceWithImage:k,deleteExperience:I,fetchExperiences:U,fetchMyExperiences:y,incrementViewCount:M,loadMoreExperiences:q,startAutoRefresh:G,stopAutoRefresh:B}=Ua(),{places:X}=wa(),{toast:E}=Ae(),{modelo:V,cargando:R,errorModelo:K,analizarImagen:J,inicializarModelo:Q}=Ca(),[u,D]=a.useState(!1),[L,P]=a.useState(!1),[se,_]=a.useState(null),[m,g]=a.useState(null),[N,i]=a.useState(null),[j,T]=a.useState(!1),[$,re]=a.useState("comunidad"),[ae,ne]=a.useState(null),[te,ce]=a.useState(!1),[he,oe]=a.useState(!0),[ie,we]=a.useState(0),xe=["Â¡Comparte tu experiencia en San Juan Tahitic!","Sube fotos de tus lugares favoritos","Inspira a otros con tus aventuras","Forma parte de nuestra comunidad viajera"],[F,le]=a.useState({descripcion:"",lugarId:"",imageFile:null,previewUrl:null,nombreUsuario:""}),ye=a.useRef(null),r=a.useRef(null);a.useEffect(()=>{const o=setInterval(()=>{we(C=>(C+1)%xe.length)},3e3);return()=>clearInterval(o)},[xe.length]),a.useEffect(()=>{(async()=>{try{await Promise.all([U({pagina:1,limite:6}),y(),Q()])}catch(C){console.error("Error inicializando datos:",C)}finally{oe(!1),G()}})()},[U,y,Q,G]);const s=a.useCallback(o=>{re(o)},[]),n=o=>{o?G():B()},p=$==="comunidad"?t:d,f=$==="comunidad"?v?.tieneMas:!1,b=$==="comunidad"&&t.length===0&&!c,w=a.useCallback(async o=>{if(!o.type.startsWith("image/")){E({title:"Tipo de archivo invÃ¡lido",description:"Por favor selecciona solo archivos de imagen.",variant:"destructive"});return}if(o.size>5*1024*1024){E({title:"Archivo muy grande",description:"La imagen no debe superar los 5MB.",variant:"destructive"});return}try{ce(!0);const C=await J(o);if(!C.esAprobado){E({title:"âŒ Imagen rechazada",description:C.razon||"La imagen no cumple con los criterios de contenido apropiado.",variant:"destructive"});return}le(ue=>({...ue,imageFile:o,previewUrl:URL.createObjectURL(o)}))}catch(C){console.error("Error analizando imagen:",C),le(ue=>({...ue,imageFile:o,previewUrl:URL.createObjectURL(o)}))}finally{ce(!1)}},[J,E]),O=o=>{const C=o.target.files?.[0];C&&w(C)},W=o=>{o.preventDefault();const C=o.dataTransfer.files[0];C&&w(C)},Ne=o=>{o.preventDefault()},Ce=a.useCallback(()=>{le({descripcion:"",lugarId:"",imageFile:null,previewUrl:null,nombreUsuario:""}),D(!1),ce(!1)},[]),ea=async()=>{if(!F.imageFile||!F.descripcion.trim()){E({title:"InformaciÃ³n requerida",description:"Por favor selecciona una imagen y escribe una descripciÃ³n.",variant:"destructive"});return}const o=await A(F.imageFile,F.descripcion,F.lugarId||void 0,F.nombreUsuario);o.success?(Ce(),E({title:"âœ… Experiencia compartida",description:"Tu experiencia ha sido publicada exitosamente.",variant:"default"})):o.necesitaTerminos&&(ne({imageFile:F.imageFile,descripcion:F.descripcion,lugarId:F.lugarId||void 0,nombreUsuario:F.nombreUsuario}),T(!0))},aa=async(o,C)=>{if(!o.trim()){E({title:"DescripciÃ³n requerida",description:"Por favor escribe una descripciÃ³n.",variant:"destructive"});return}m&&await H(m.id,o,C)&&(g(null),P(!1),E({title:"âœ… Experiencia actualizada",description:"Tu experiencia ha sido actualizada correctamente.",variant:"default"}))},ta=async(o,C,ue)=>{if(!o.trim()){E({title:"DescripciÃ³n requerida",description:"Por favor escribe una descripciÃ³n.",variant:"destructive"});return}if(m){let Le=!1;Le=await k(m.id,o,C,ue),Le&&(g(null),P(!1),E({title:"âœ… Experiencia actualizada",description:C?"Tu experiencia e imagen han sido actualizadas correctamente.":"Tu experiencia ha sido actualizada correctamente.",variant:"default"}))}},sa=async()=>{N&&await I(N.id)&&i(null)},ra=o=>{g(o),P(!0)},ia=o=>{i(o)},la=async()=>{ae&&(localStorage.setItem("experience_terms_accepted","true"),(await A(ae.imageFile,ae.descripcion,ae.lugarId,ae.nombreUsuario)).success&&(Ce(),ne(null),T(!1)))},Ee=async o=>{_(o);try{(await M(o.id)).success&&console.log("âœ… Vista procesada para:",o.id)}catch(C){console.error("âŒ Error al registrar vista:",C)}},Oe=o=>new Date(o).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"});return he?e.jsxs("section",{className:"py-20 relative min-h-screen overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-cover bg-center z-0",style:{backgroundImage:"url(https://res.cloudinary.com/dinsl266g/image/upload/v1763074398/fondo-galeria_urye7x.svg)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",filter:"blur(6px) brightness(0.85) saturate(0.8)"}}),e.jsx("div",{className:"absolute inset-0 bg-black/45 backdrop-blur-[1px] z-0"}),e.jsxs("div",{className:"container mx-auto px-4 relative z-10",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsxs("h2",{className:"text-4xl font-bold text-gray-900 mb-4",children:["Mural de ",e.jsx("span",{className:"text-blue-600",children:"Experiencias"})]}),e.jsx("p",{className:"text-xl text-gray-600",children:"Cargando experiencias..."})]}),e.jsx(We,{count:6})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:"py-20 relative min-h-screen overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-cover bg-center z-0",style:{backgroundImage:"url(https://res.cloudinary.com/dinsl266g/image/upload/v1763114788/Fondos-numericos_wvaraf.svg)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",filter:"blur(4px) brightness(0.9)"}}),e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-[1px] z-0"}),e.jsxs("div",{className:"container mx-auto px-4 relative z-10",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-8 gap-4",children:[e.jsxs("div",{className:"text-center md:text-left",children:[e.jsxs("h2",{className:"text-4xl font-bold text-white mb-2",children:[" ","Mural de ",e.jsx("span",{className:"text-blue-300",children:"Experiencias"})," "]}),e.jsxs("p",{className:"text-xl text-gray-200",children:[" ","Historias y momentos compartidos por la comunidad"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Te,{modelo:!!V,cargando:R,errorModelo:K}),e.jsxs(Y,{onClick:()=>D(!0),className:"bg-gradient-to-r from-blue-500 to-green-500 hover:from-blue-600 hover:to-green-600 text-white font-semibold flex items-center gap-2 px-6 py-3 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(Be,{className:"w-5 h-5"}),"Compartir Experiencia"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-300 mb-4",children:[" ",e.jsx("div",{className:`w-2 h-2 rounded-full ${S?"bg-green-400 animate-pulse":"bg-gray-500"}`}),e.jsxs("span",{children:["ActualizaciÃ³n automÃ¡tica: ",S?"Activada":"Desactivada"]}),e.jsx(Y,{variant:"ghost",size:"sm",onClick:()=>n(!S),className:"h-6 px-2 text-xs text-gray-300 hover:text-white hover:bg-white/10",children:S?"Desactivar":"Activar"})]}),e.jsxs("div",{className:"flex border-b border-gray-600 mb-6 bg-white/10 backdrop-blur-sm rounded-t-xl p-2",children:[" ",e.jsx("button",{onClick:()=>s("comunidad"),className:`px-6 py-3 font-medium text-lg rounded-lg transition-all ${$==="comunidad"?"text-white bg-blue-500/30 shadow-sm":"text-gray-300 hover:text-white hover:bg-white/10"}`,children:"ðŸ‘¥ Comunidad"}),e.jsx("button",{onClick:()=>s("mis-experiencias"),className:`px-6 py-3 font-medium text-lg rounded-lg transition-all ${$==="mis-experiencias"?"text-white bg-blue-500/30 shadow-sm":"text-gray-300 hover:text-white hover:bg-white/10"}`,children:"ðŸ“± Mis Experiencias"})]}),$==="mis-experiencias"&&e.jsx(Fa,{myExperiences:d}),$==="comunidad"&&e.jsxs(Z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.7},className:"relative bg-gradient-to-r from-blue-500/30 via-green-500/30 to-emerald-500/30 rounded-2xl p-6 mb-8 overflow-hidden border border-white/20 backdrop-blur-sm",children:[e.jsx("div",{className:"absolute -top-10 -left-10 w-32 h-32 bg-blue-400/20 rounded-full blur-xl"}),e.jsx("div",{className:"absolute -bottom-8 -right-8 w-28 h-28 bg-emerald-400/20 rounded-full blur-xl"}),e.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row items-center justify-between gap-6",children:[e.jsxs("div",{className:"flex-1 text-center md:text-left",children:[e.jsxs("div",{className:"flex items-center justify-center md:justify-start gap-2 mb-2",children:[e.jsx(Me,{className:"w-6 h-6 text-blue-300"})," ",e.jsx("h3",{className:"text-xl font-bold text-white",children:"Mural de Experiencias"})," "]}),e.jsx(ge,{mode:"wait",children:e.jsx(Z.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.5},className:"text-lg text-gray-200 mb-4",children:xe[ie]},ie)}),e.jsxs("div",{className:"flex flex-wrap gap-2 justify-center md:justify-start",children:[e.jsx("span",{className:"px-3 py-1 bg-blue-500/30 text-blue-200 rounded-full text-sm",children:"#Aventuras"})," ",e.jsx("span",{className:"px-3 py-1 bg-green-500/30 text-green-200 rounded-full text-sm",children:"#Naturaleza"})," ",e.jsx("span",{className:"px-3 py-1 bg-emerald-500/30 text-emerald-200 rounded-full text-sm",children:"#Comunidad"})," "]})]}),e.jsxs(Z.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:[e.jsx(Xe,{className:"w-16 h-16 text-blue-400/40"})," "]})]})]}),e.jsx("div",{className:"min-h-[400px]",children:c&&p.length===0?e.jsx(We,{count:6}):p.length===0?e.jsx(Va,{activeTab:$,onUploadClick:()=>D(!0),isCommunityEmpty:b}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.jsx(ge,{children:p.map((o,C)=>e.jsxs(Z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:C*.1},className:"bg-white/95 backdrop-blur-sm rounded-2xl overflow-hidden shadow-card hover:shadow-2xl transition-all duration-300 group relative border border-white/30",children:[e.jsxs("div",{className:"relative overflow-hidden",children:[e.jsx("img",{src:o.url_foto,alt:o.descripcion,className:"w-full h-64 object-cover group-hover:scale-105 transition-transform duration-500 cursor-pointer",onClick:()=>Ee(o)}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300",onClick:()=>Ee(o)}),$==="mis-experiencias"&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsxs(oa,{children:[e.jsx(na,{asChild:!0,children:e.jsx(Y,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 bg-black/60 hover:bg-black/80 text-white",children:e.jsx(xa,{className:"h-4 w-4"})})}),e.jsxs(ca,{align:"end",className:"bg-white border border-gray-200 shadow-lg",children:[e.jsxs(Pe,{onClick:()=>ra(o),disabled:h===o.id,className:"focus:text-blue-600",children:[e.jsx(ga,{className:"w-4 h-4 mr-2"}),h===o.id?"Editando...":"Editar"]}),e.jsxs(Pe,{onClick:()=>ia(o),disabled:x===o.id,className:"text-red-600 focus:text-red-600",children:[e.jsx(ba,{className:"w-4 h-4 mr-2"}),x===o.id?"Eliminando...":"Eliminar"]})]})]})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"mb-3",children:e.jsx($a,{nombreUsuario:o.nombre_usuario})}),e.jsx("p",{className:"text-gray-700 line-clamp-2 mb-3 leading-relaxed cursor-pointer",onClick:()=>Ee(o),children:o.descripcion}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ye,{className:"w-4 h-4"}),e.jsxs("span",{children:[o.contador_vistas," vistas"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(_e,{className:"w-4 h-4"}),e.jsx("span",{children:Oe(o.creado_en)})]})]}),o.lugar_nombre&&e.jsxs("div",{className:"flex items-center gap-1 text-blue-600",children:[e.jsx(De,{className:"w-4 h-4"}),e.jsx("span",{className:"truncate max-w-[100px]",children:o.lugar_nombre})]})]})]})]},o.id))})}),$==="comunidad"&&e.jsx(qa,{loading:z,hasMore:f,onClick:q})]})})]})]}),e.jsx(be,{open:u,onOpenChange:D,children:e.jsxs(fe,{className:"max-w-4xl max-h-[95vh] overflow-hidden bg-slate-900/95 backdrop-blur-sm border border-slate-700 shadow-xl text-white flex flex-col ",children:[e.jsxs(Se,{children:[e.jsx(ze,{className:"text-center",children:"Compartir Experiencia"}),e.jsx(Ie,{className:"text-white/70",children:"Comparte tu foto y experiencia en San Juan Tahitic"})]}),e.jsxs("div",{className:"space-y-4 bg-scroll overflow-y-auto px-6 pb-6 flex-1",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Tu nombre (opcional)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Je,{className:"w-4 h-4 text-gray-400"}),e.jsx(je,{placeholder:"CÃ³mo quieres que te llamen (mÃ¡x. 50 caracteres)",value:F.nombreUsuario,onChange:o=>le(C=>({...C,nombreUsuario:o.target.value})),maxLength:50,className:"bg-white/10 border-white/20 text-white placeholder-gray-400"})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:'ðŸ’¡ Si dejas este campo vacÃ­o, se mostrarÃ¡ como "Usuario AnÃ³nimo"'})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-white",children:"Imagen de la experiencia *"}),e.jsx(Te,{modelo:!!V,cargando:R,errorModelo:K})]}),e.jsxs("div",{ref:r,onDrop:W,onDragOver:Ne,onClick:()=>!te&&ye.current?.click(),className:`border-2 border-dashed rounded-lg p-6 text-center cursor-pointer transition-colors ${te?"border-yellow-400 bg-yellow-400/10 cursor-not-allowed":"border-blue-300 hover:border-blue-400"}`,children:[te?e.jsxs("div",{className:"flex flex-col items-center justify-center py-4",children:[e.jsx(de,{className:"w-8 h-8 text-yellow-400 animate-spin mb-2"}),e.jsx("p",{className:"text-yellow-400 font-medium",children:"Analizando imagen..."}),e.jsx("p",{className:"text-sm text-yellow-300 mt-1",children:"Verificando contenido apropiado"})]}):F.previewUrl?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:F.previewUrl,alt:"Vista previa",className:"w-full h-40 object-cover rounded-md mx-auto"}),e.jsx("button",{onClick:o=>{o.stopPropagation(),le(C=>({...C,previewUrl:null,imageFile:null}))},className:"absolute -top-2 -right-2 p-1 bg-red-500 text-white rounded-full hover:bg-red-600",children:e.jsx(ve,{className:"w-4 h-4"})})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ke,{className:"w-12 h-12 text-blue-400 mx-auto mb-3"}),e.jsx("p",{className:"text-blue-400 font-medium",children:"Selecciona una imagen"}),e.jsx("p",{className:"text-sm text-white/70 mt-1",children:"Arrastra y suelta o haz clic para seleccionar"}),e.jsx("p",{className:"text-xs text-blue-300 mt-2",children:"ðŸ” La imagen serÃ¡ analizada automÃ¡ticamente"})]}),e.jsx(je,{ref:ye,type:"file",accept:"image/*",onChange:O,className:"hidden",disabled:te})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Describe tu experiencia *"}),e.jsx(Qe,{placeholder:"Comparte los detalles de tu experiencia en San Juan Tahitic...",value:F.descripcion,onChange:o=>le(C=>({...C,descripcion:o.target.value})),rows:4,className:"resize-none bg-white/10 border-white/20 text-white placeholder-gray-400"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"ðŸ’¡ El texto serÃ¡ validado automÃ¡ticamente al compartir"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Lugar relacionado (opcional)"}),e.jsxs("select",{value:F.lugarId,onChange:o=>le(C=>({...C,lugarId:o.target.value})),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-black bg-white",children:[e.jsx("option",{value:"",children:"Selecciona un lugar"}),X.map(o=>e.jsx("option",{value:o.id,children:o.nombre},o.id))]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(Y,{variant:"outline",onClick:Ce,disabled:te,className:"flex-1 hover:bg-red-900 text-white border-white/30",children:"Cancelar"}),e.jsx(Y,{onClick:ea,disabled:!F.imageFile||!F.descripcion.trim()||l||te,className:"flex-1 bg-blue-600 hover:bg-blue-700",children:te?e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"w-4 h-4 animate-spin mr-2"}),"Analizando..."]}):l?e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"w-4 h-4 animate-spin mr-2"}),"Subiendo..."]}):"Compartir Experiencia"})]})]})]})}),e.jsx(Wa,{experience:m,isOpen:L,onClose:()=>{g(null),P(!1)},onSave:aa,onSaveWithImage:ta,loading:h===m?.id,modelo:!!V,cargandoModelo:R,errorModelo:K,analizarImagen:J}),e.jsx(be,{open:!!N,onOpenChange:()=>i(null),children:e.jsxs(fe,{className:"max-w-md overflow-hidden bg-slate-900/95 backdrop-blur-sm border border-slate-700 shadow-xl text-white flex flex-col",children:[e.jsxs(Se,{children:[e.jsx(ze,{children:"Â¿Eliminar Experiencia?"}),e.jsx(Ie,{children:"Esta acciÃ³n no se puede deshacer. La experiencia serÃ¡ eliminada permanentemente."})]}),N&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4 items-start",children:[e.jsx("img",{src:N.url_foto,alt:"Experiencia",className:"w-20 h-20 object-cover rounded-lg"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-700 line-clamp-3",children:N.descripcion}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Publicado el ",Oe(N.creado_en)]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[N.contador_vistas," vistas"]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Por: ",N.nombre_usuario||"Usuario AnÃ³nimo"]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(Y,{variant:"outline",onClick:()=>i(null),className:"flex-1 hover:bg-gray-800 text-white border-gray-600",children:"Cancelar"}),e.jsx(Y,{onClick:sa,disabled:x===N.id,variant:"destructive",className:"flex-1 bg-red-600 hover:bg-red-700",children:x===N.id?e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"w-4 h-4 animate-spin mr-2"}),"Eliminando..."]}):"Eliminar"})]})]})]})}),e.jsx(Pa,{experience:se,isOpen:!!se,onClose:()=>_(null)}),e.jsx(Na,{isOpen:j,onClose:()=>{T(!1),ne(null)},onAccept:la,type:"experience",title:"TÃ©rminos para Compartir Experiencias",description:"Al compartir tu experiencia, aceptas nuestros tÃ©rminos de uso y polÃ­tica de privacidad.",placeName:""})]})};function st(){return e.jsxs(e.Fragment,{children:[e.jsx(La,{}),e.jsx(Za,{})]})}export{st as GallerySection};
